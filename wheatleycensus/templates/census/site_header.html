{% load static %}

<header class="site-header">
  <!-- Sign-in / Admin Buttons -->
  <div class="tucked">
    {% if user.is_authenticated %}
      <a class="button" href="{% url 'logout_user' %}">Sign out</a>
      <a class="button" href="{% url 'admin:index' %}">Admin</a>
    {% else %}
      <a class="button" href="{% url 'login_user' %}">Sign in</a>
    {% endif %}
  </div>

  <!-- Title & Navigation -->
  <div class="outer-frame nav-wrap">
    <h1 class="site-title">
      <a href="{% url 'homepage' %}">Wheatley Census</a>
    </h1>
    <nav class="main-nav">
      <a href="{% url 'homepage' %}">Home</a>
      <a href="{% url 'about' %}">About</a>
      <a href="#" id="site-search-button" aria-expanded="false">Search</a>
    </nav>
  </div>

  <!-- Collapsible Search Bar -->
  <div class="search-bar hidden" id="search-bar-form">
    <form action="{% url 'search' %}" method="get" class="search-form">
      <details>
        <summary>Search & Filters</summary>
        <select name="field">
          <option disabled selected value>Search by...</option>
          <option value="keyword"{% if request.GET.field == 'keyword' %} selected{% endif %}>Keyword</option>
          <option value="location"{% if request.GET.field == 'location' %} selected{% endif %}>Location</option>
          <option value="provenance_name"{% if request.GET.field == 'provenance_name' %} selected{% endif %}>Provenance Name</option>
          <option value="collection"{% if request.GET.field == 'collection' %} selected{% endif %}>Specific Features</option>
          <option value="year"{% if request.GET.field == 'year' %} selected{% endif %}>Year</option>
          <option value="stc"{% if request.GET.field == 'stc' %} selected{% endif %}>STC / Wing #</option>
          <option value="census_id"{% if request.GET.field == 'census_id' %} selected{% endif %}>MC #</option>
        </select>
        <input type="text" name="value" placeholder="Enter search term..." value="{{ request.GET.value|default_if_none:'' }}" />
        <button type="submit" class="button">Go</button>
      </details>
    </form>
  </div>
</header>

<script>
  document.getElementById('site-search-button').addEventListener('click', function(e) {
    e.preventDefault();
    document.getElementById('search-bar-form').classList.toggle('hidden');
  });
</script>
