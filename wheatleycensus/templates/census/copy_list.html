{% extends "census/base.html" %}
{% load static %}
{% load humanize %}

{% block content %}
<div class="wrapper">
  <div>
    <script src="{% static 'census/js/bootstrap-modal.js' %}"></script>
    <script src="{% static 'census/js/copy_detail_edit_modal.js' %}"></script>
    <link rel="stylesheet" href="{% static 'census/css/modal.css' %}" />
    <div id="copyModal" class="modal fade" role="dialog"></div>
  </div>

  {% include "census/play-title-header.html"
      with selected_issue=selected_issue
           icon_path=icon_path
           title=title
           copy_count=copy_count %}

  <table class="play-detail-set">

    {# ——————————————————————————————————————— #}
    {# Header in a <thead>                             #}
    {# ——————————————————————————————————————— #}
    <thead>
      <tr>
        <th class="terse">WC&nbsp;#</th>
        <th class="detailed">Location</th>
        <th class="even">Shelfmark</th>
        <th class="icon">&nbsp;</th>
        <th class="icon">&nbsp;</th>
        <th class="icon">&nbsp;</th>
      </tr>
    </thead>

    {# ——————————————————————————————————————— #}
    {# Body with for…empty…endfor                     #}
    {# ——————————————————————————————————————— #}
    <tbody>
      {% for copy in all_copies %}
      <tr>
        <td>
          {% if copy.census_id and copy.census_id != '0' %}
            <a class="copy_data"
               href="#"
               data-form="{% url 'copy_data' copy.id %}"
               title="Details">
              {{ copy.census_id }}
            </a>
          {% else %}
            &nbsp;
          {% endif %}
          {% if user.is_staff %}
            <span class="note">
              [<a href="{% url 'admin:wheatleycensus_copy_change' copy.id %}">
                 Edit copy
               </a>]
            </span>
          {% endif %}
        </td>
        <td>
          <a class="copy_data"
             href="#"
             data-form="{% url 'copy_data' copy.id %}"
             title="Details">
            {{ copy.location.name_of_library_collection }}
          </a>
        </td>
        <td>
          {% if copy.shelfmark and copy.shelfmark != "[Shelfmark not available]" %}
            <a class="copy_data"
               href="#"
               data-form="{% url 'copy_data' copy.id %}"
               title="Details">
              {{ copy.shelfmark }}
            </a>
          {% else %}
            &nbsp;
          {% endif %}
        </td>
        <td>
          {% if copy.from_estc and copy.verification == "U" %}
            <span title="Unverified (via ESTC)"
                  class="unverified-symbol">&#x20E0;</span>
          {% elif copy.verification == "U" %}
            <span title="Unverified (admin entered)"
                  class="unverified-symbol">&#x20E0;</span>
          {% elif copy.verification == "V" %}
            <span title="Verified" class="verified-symbol">&#x2713;</span>
          {% endif %}
        </td>
        <td>
          {% if copy.fragment %}
            <span class="unicode-icon" title="Fragment copy">
              <i class="fas fa-industry"></i>
            </span>
          {% endif %}
        </td>
        <td>
          {% if copy.digital_facsimile_url %}
            <span class="unicode-icon" title="Digital facsimile">
              <a href="{{ copy.digital_facsimile_url }}"
                 target="_blank">
                <i class="fas fa-camera-retro"></i>
              </a>
            </span>
          {% endif %}
        </td>
      </tr>

      {# This replaces your invalid `{% else %}` inside a loop #}
      {% empty %}
      <tr>
        <td colspan="6" style="text-align:center; padding:20px;">
          No copies are available.
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock content %}
